{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const fetchImages = (searchedQuery,currentPage) => {\n\n  const axiosOptions = {\n    params: {\n    q: encodeURIComponent(searchedQuery),\n    key: '48226590-99b6af351d6e3a0b674791be6', \n    per_page: 15,\n    page: currentPage,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    }\n  }\n\n    return axios.get(`https://pixabay.com/api/`,axiosOptions)\n  };\n\n    \n\n  \n    \n\n\n","export const createGalleryCard = imgInfo => {\n   return `\n    <li class=\"gallery-card\">\n      <a href=\"${imgInfo.largeImageURL}\" target=\"_blank\">\n        <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" />\n      </a>\n      <p>Likes: ${imgInfo.likes}  Views: ${imgInfo.views}  Comments: ${imgInfo.comments}  Downloads: ${imgInfo.downloads}</p>\n    </li>`;\n};\n\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"; \nimport { fetchImages } from './js/pixabay-api.js';\nimport { createGalleryCard } from \"./js/render-functions.js\";\n\nconst searchFormEl = document.querySelector(\".search-form\");\nconst galleryEl = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadButton = document.querySelector(\".load-button\");\n\nlet page = 1;\nlet query = \"\";\n\nlet lightbox = new SimpleLightbox(\".gallery a\",\n  {\n    captionsData: 'alt',\n    captionDelay: 250\n  });\n\n\nconst onSearchFormSubmit = async (event) => {\n  try {\n    event.preventDefault();\n\n    query = event.currentTarget.elements.user_query.value.trim();\n\n    if (query === \"\") {\n      iziToast.error({\n        message: \"Please fill the form\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    page = 1;\n    loadButton.classList.add(\"is-hidden\");\n    loader.classList.remove(\"is-hidden\");\n\n    const { data } = await fetchImages(query, page);\n\n    if (data.total === 0) {\n      iziToast.error({\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n\n      galleryEl.innerHTML = \"\";\n      loader.classList.add(\"is-hidden\");\n      searchFormEl.reset();\n      return;\n    }\n\n\n    const totalPages = Math.ceil(data.totalHits / 15); \n\n    const galleryMarkup = data.hits.map(el => createGalleryCard(el)).join('');\n    galleryEl.innerHTML = galleryMarkup;\n\n    lightbox.refresh();\n\n    loader.classList.add(\"is-hidden\");\n   \n    \n    if (totalPages > 1) {\n      loadButton.classList.remove(\"is-hidden\");\n      loadButton.onclick = () => onLoadBtnClick(totalPages);\n    }\n\n  \n\n    searchFormEl.reset();\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      message: \"Something went wrong, please try again later.\",\n      position: \"topRight\",\n    });\n    loader.classList.add(\"is-hidden\");\n  }\n};\n\nconst onLoadBtnClick = async (totalPages) => {\n  try {\n    page++;\n\n    loadButton.classList.add(\"is-hidden\");\n    loader.classList.remove(\"is-hidden\");\n\n    const { data } = await fetchImages(query, page);\n    const galleryMarkup = data.hits.map(el => createGalleryCard(el)).join('');\n    galleryEl.insertAdjacentHTML('beforeend', galleryMarkup);\n\n    lightbox.refresh();\n\n\n    const cardHeight = document.querySelector('.gallery-card').getBoundingClientRect().height;\n\n   \n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth'\n    });\n\n    loader.classList.add(\"is-hidden\");\n\n    \n    if (page >= totalPages) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    }\n    else {\n       loadButton.classList.remove(\"is-hidden\");\n      }\n    }\n   catch (err) {\n    console.log(err);\n     iziToast.error({\n      message: \"Something went wrong, please try again later.\",\n      position: \"topRight\",\n    });\n    loader.classList.add(\"is-hidden\");\n    loadButton.classList.remove(\"is-hidden\")\n  }\n};\n\nsearchFormEl.addEventListener(\"submit\", onSearchFormSubmit);"],"names":["fetchImages","searchedQuery","currentPage","axiosOptions","axios","createGalleryCard","imgInfo","searchFormEl","galleryEl","loader","loadButton","page","query","lightbox","SimpleLightbox","onSearchFormSubmit","event","iziToast","data","totalPages","galleryMarkup","el","onLoadBtnClick","err","cardHeight"],"mappings":"owBAEO,MAAMA,EAAc,CAACC,EAAcC,IAAgB,CAExD,MAAMC,EAAe,CACnB,OAAQ,CACR,EAAG,mBAAmBF,CAAa,EACnC,IAAK,qCACL,SAAU,GACV,KAAMC,EACN,WAAY,QACZ,YAAa,aACb,WAAY,EACX,CACF,EAEC,OAAOE,EAAM,IAAI,2BAA2BD,CAAY,CACzD,ECjBUE,EAAoBC,GACvB;AAAA;AAAA,iBAEOA,EAAQ,aAAa;AAAA,wCACEA,EAAQ,YAAY,UAAUA,EAAQ,IAAI;AAAA;AAAA,kBAEhEA,EAAQ,KAAK,YAAYA,EAAQ,KAAK,eAAeA,EAAQ,QAAQ,gBAAgBA,EAAQ,SAAS;AAAA,WCClHC,EAAe,SAAS,cAAc,cAAc,EACpDC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAa,SAAS,cAAc,cAAc,EAExD,IAAIC,EAAO,EACPC,EAAQ,GAERC,EAAW,IAAIC,EAAe,aAChC,CACE,aAAc,MACd,aAAc,GAClB,CAAG,EAGH,MAAMC,EAAqB,MAAOC,GAAU,CAC1C,GAAI,CAKF,GAJAA,EAAM,eAAc,EAEpBJ,EAAQI,EAAM,cAAc,SAAS,WAAW,MAAM,OAElDJ,IAAU,GAAI,CAChBK,EAAS,MAAM,CACb,QAAS,uBACT,SAAU,UAClB,CAAO,EACD,MACD,CAEDN,EAAO,EACPD,EAAW,UAAU,IAAI,WAAW,EACpCD,EAAO,UAAU,OAAO,WAAW,EAEnC,KAAM,CAAE,KAAAS,CAAI,EAAK,MAAMlB,EAAYY,EAAOD,CAAI,EAE9C,GAAIO,EAAK,QAAU,EAAG,CACpBD,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,UAClB,CAAO,EAEDT,EAAU,UAAY,GACtBC,EAAO,UAAU,IAAI,WAAW,EAChCF,EAAa,MAAK,EAClB,MACD,CAGD,MAAMY,EAAa,KAAK,KAAKD,EAAK,UAAY,EAAE,EAE1CE,EAAgBF,EAAK,KAAK,IAAIG,GAAMhB,EAAkBgB,CAAE,CAAC,EAAE,KAAK,EAAE,EACxEb,EAAU,UAAYY,EAEtBP,EAAS,QAAO,EAEhBJ,EAAO,UAAU,IAAI,WAAW,EAG5BU,EAAa,IACfT,EAAW,UAAU,OAAO,WAAW,EACvCA,EAAW,QAAU,IAAMY,EAAeH,CAAU,GAKtDZ,EAAa,MAAK,CACnB,OAAQgB,EAAK,CACZ,QAAQ,IAAIA,CAAG,EACfN,EAAS,MAAM,CACb,QAAS,gDACT,SAAU,UAChB,CAAK,EACDR,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,EAEMa,EAAiB,MAAOH,GAAe,CAC3C,GAAI,CACFR,IAEAD,EAAW,UAAU,IAAI,WAAW,EACpCD,EAAO,UAAU,OAAO,WAAW,EAEnC,KAAM,CAAE,KAAAS,CAAI,EAAK,MAAMlB,EAAYY,EAAOD,CAAI,EACxCS,EAAgBF,EAAK,KAAK,IAAIG,GAAMhB,EAAkBgB,CAAE,CAAC,EAAE,KAAK,EAAE,EACxEb,EAAU,mBAAmB,YAAaY,CAAa,EAEvDP,EAAS,QAAO,EAGhB,MAAMW,EAAa,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAGnF,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,EAEDf,EAAO,UAAU,IAAI,WAAW,EAG5BE,GAAQQ,EACVF,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAClB,CAAO,EAGAP,EAAW,UAAU,OAAO,WAAW,CAEzC,OACKa,EAAK,CACX,QAAQ,IAAIA,CAAG,EACdN,EAAS,MAAM,CACd,QAAS,gDACT,SAAU,UAChB,CAAK,EACDR,EAAO,UAAU,IAAI,WAAW,EAChCC,EAAW,UAAU,OAAO,WAAW,CACxC,CACH,EAEAH,EAAa,iBAAiB,SAAUQ,CAAkB"}